(this.webpackJsonprandomgame=this.webpackJsonprandomgame||[]).push([[0],{183:function(e,t,i){e.exports=i(224)},187:function(e,t,i){},219:function(e,t){},224:function(e,t,i){"use strict";i.r(t);var n,a=i(27),s=i.n(a),r=i(179),o=i.n(r),c=(i(187),i(33)),h=i(35),u=i(38),l=i(41),d=i(36),f=i.n(d),y=i(50),b=i(32),p=i(157),v=i(89),g=i(51),m=i(39),k=function(){function e(t){Object(c.a)(this,e),this.gameScene=t,this.renderer=null,this.position=b.Vector2.Zero(),this.visibility=!0}return Object(h.a)(e,[{key:"attachRenderer",value:function(){var e=Object(y.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.renderer&&this.renderer.attached&&this.renderer.detach();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"detachRenderer",value:function(){var e=Object(y.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.renderer&&this.renderer.detach();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){this.renderer&&this.renderer.update()}},{key:"tick",value:function(e){}},{key:"setVisibility",value:function(e){this.visibility=e,this.renderer&&this.renderer.update()}},{key:"getVisibility",value:function(){return this.visibility}}]),e}();!function(e){e.Server="SERVER",e.Client="CLIENT"}(n||(n={}));var x=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n){var a;return Object(c.a)(this,i),(a=t.call(this,e)).gameScene=e,a.id=n,a.disabled=!1,a.hitbox={width:0,height:0},a.velocity=b.Vector2.Zero(),a.controllerManager=void 0,a.dirtyListener=function(e){},a}return Object(h.a)(i,[{key:"serialize",value:function(){return{id:this.id,x:this.position.x,y:this.position.y,velocityX:this.velocity.x,velocityY:this.velocity.y,type:i.type,data:{}}}},{key:"deserializeImmediatelly",value:function(e){this.position.x=e.x,this.position.y=e.y,this.velocity.x=e.velocityX,this.velocity.y=e.velocityY,this.deserialize(e),this.update()}},{key:"deserialize",value:function(e){this.controllerManager.invoke("deserialize",e),this.update()}},{key:"attachDirtyListener",value:function(e){this.dirtyListener=e}},{key:"setDirty",value:function(){this.dirtyListener(this.id)}},{key:"setVisibilityAttachRenderer",value:function(){var e=Object(y.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.a)(Object(m.a)(i.prototype),"setVisibility",this).call(this,t),t&&!this.renderer&&this.attachRenderer(n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"colidesWith",value:function(e){return this.position.x-this.hitbox.width<e.position.x+e.hitbox.width&&this.position.x+this.hitbox.width>e.position.x-e.hitbox.width&&this.position.y-this.hitbox.height<e.position.y+e.hitbox.height&&this.position.y+this.hitbox.height>e.position.y-e.hitbox.height}},{key:"tick",value:function(e){this.controllerManager.invoke("tick",e)}}],[{key:"type",get:function(){return"unknown"}}]),i}(k),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(c.a)(this,e),this.controllers=t}return Object(h.a)(e,[{key:"attach",value:function(e){this.controllers.push(e)}},{key:"detach",value:function(e){this.controllers=this.controllers.filter(e)}},{key:"invoke",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.controllers.forEach((function(t){var n;return t[e]&&(n=t)[e].apply(n,i)}))}}]),e}(),j=function(){function e(t){Object(c.a)(this,e),this.object=t}return Object(h.a)(e,[{key:"tick",value:function(e){}},{key:"deserialize",value:function(e){}}]),e}(),O=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,e)).object=e,n}return Object(h.a)(i,[{key:"deserialize",value:function(e){this.object.position.x=e.x,this.object.position.y=e.y,this.object.velocity.x=e.velocityX,this.object.velocity.y=e.velocityY}}]),i}(j),S=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,e)).object=e,n.targetX=0,n.targetY=0,n.finalVelocityX=0,n.finalVelocityY=0,n.targetTime=-1,n.smoothTime=110,n}return Object(h.a)(i,[{key:"tick",value:function(e){if(this.targetTime>0)return this.object.position.x+=this.object.velocity.x*e,this.object.position.y+=this.object.velocity.y*e,this.targetTime-=e,void(this.targetTime<=0&&(this.object.position.x=this.targetX,this.object.position.y=this.targetY,this.object.velocity.x=this.finalVelocityX,this.object.velocity.y=this.finalVelocityY));Object(g.a)(Object(m.a)(i.prototype),"tick",this).call(this,e)}},{key:"setSmoothTime",value:function(e){this.smoothTime=e}},{key:"deserialize",value:function(e){this.targetX=e.x,this.targetY=e.y,this.finalVelocityX=e.velocityX,this.finalVelocityY=e.velocityY,this.targetTime=this.smoothTime,this.object.velocity.x=(e.x-this.object.position.x)/this.smoothTime,this.object.velocity.y=(e.y-this.object.position.y)/this.smoothTime}}]),i}(j),T=i(112),M=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,e)).object=e,n.keyBindings={up:0,down:0,left:0,right:0},n}return Object(h.a)(i,[{key:"tick",value:function(e){var t=this,i=.1*e,n=!1,a=!1,s=Math.sqrt(2);(this.keysPressed.includes(this.keyBindings.left)||this.keysPressed.includes(this.keyBindings.right))&&(n=!0),(this.keysPressed.includes(this.keyBindings.up)||this.keysPressed.includes(this.keyBindings.down))&&(a=!0),this.keysPressed.includes(this.keyBindings.left)&&(this.object.velocity.x-=.002*i/(a?s:1)),this.keysPressed.includes(this.keyBindings.right)&&(this.object.velocity.x+=.002*i/(a?s:1)),this.keysPressed.includes(this.keyBindings.up)&&(this.object.velocity.y-=.002*i/(n?s:1)),this.keysPressed.includes(this.keyBindings.down)&&(this.object.velocity.y+=.002*i/(n?s:1));var r=this.object.position.x,o=this.object.position.y;this.object.position.x+=this.object.velocity.x*i,this.object.position.y+=this.object.velocity.y*i,this.object.velocity.x*=Math.pow(.95,i),this.object.velocity.y*=Math.pow(.95,i),Math.abs(this.object.velocity.x)<.001&&(this.object.velocity.x=0),Math.abs(this.object.velocity.y)<.001&&(this.object.velocity.y=0);var c=this.object.gameScene.getColisions(this.object);if(c.length()>0){var h=!1,u=!1;c.forEach((function(e){var i=!(o-t.object.hitbox.height<e.position.y+e.hitbox.height)&&t.object.position.y-t.object.hitbox.height<e.position.y+e.hitbox.height,n=!(r+t.object.hitbox.width>e.position.x-e.hitbox.width)&&t.object.position.x+t.object.hitbox.width>e.position.x-e.hitbox.width,a=!(o+t.object.hitbox.height>e.position.y-e.hitbox.height)&&t.object.position.y+t.object.hitbox.height>e.position.y-e.hitbox.height,s=!(r-t.object.hitbox.width<e.position.x+e.hitbox.width)&&t.object.position.x-t.object.hitbox.width<e.position.x+e.hitbox.width;h=h||n||s,u=u||i||a})),h&&(this.object.position.x=r,this.object.velocity.x=0),u&&(this.object.position.y=o,this.object.velocity.y=0)}}},{key:"bindKeys",value:function(e){this.keyBindings=Object(T.a)(Object(T.a)({},this.keyBindings),e)}}]),i}(function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(){var e;Object(c.a)(this,i);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).keysPressed=[],e.mousePressed=[],e}return Object(h.a)(i,[{key:"keyDown",value:function(e){this.keysPressed.includes(e)||this.keysPressed.push(e)}},{key:"keyUp",value:function(e){this.keysPressed.includes(e)&&(this.keysPressed=this.keysPressed.filter((function(t){return t!==e})))}},{key:"mouseDown",value:function(e){this.mousePressed.includes(e)||this.mousePressed.push(e)}},{key:"mouseUp",value:function(e){this.mousePressed.includes(e)&&(this.mousePressed=this.mousePressed.filter((function(t){return t!==e})))}}]),i}(j)),_=i(114),R={player:{filename:"Character.png",width:57,animations:{default:{start:0,end:0,type:"frame"},walking:{start:0,end:7,type:"loop"},inventory_opening:{start:8,end:11,type:"once"},inventory_open:{start:11,end:11,type:"frame"},inventory_closing:{start:11,end:8,type:"once"},equip:{start:12,end:19,type:"once"},unequip:{start:19,end:12,type:"once"},mine:{start:20,end:22,type:"boomerang"},eat:{start:23,end:51,type:"once"},interact:{start:52,end:56,type:"once"}}},chicken:{filename:"chicken.png",width:1,animations:{}},rock_big:{filename:"rock_big.png",width:1,animations:{}},rock_small:{filename:"rock_small.png",width:1,animations:{}},bush:{filename:"bush.png",width:1,animations:{}},tree_small:{filename:"tree_small.png",width:1,animations:{}},tree_big:{filename:"tree_big.png",width:1,animations:{}},tree_short:{filename:"tree_short.png",width:1,animations:{}},tree_tall:{filename:"tree_tall.png",width:1,animations:{}},grass_water_L:{filename:"grass_water_L.png",width:1,animations:{}},grass_water_R:{filename:"grass_water_R.png",width:1,animations:{}},grass_water_T:{filename:"grass_water_T.png",width:1,animations:{}},grass_water_B:{filename:"grass_water_B.png",width:1,animations:{}},grass_water_TL:{filename:"grass_water_TL.png",width:1,animations:{}},grass_water_RB:{filename:"grass_water_RB.png",width:1,animations:{}},grass_water_TR:{filename:"grass_water_TR.png",width:1,animations:{}},grass_water_BL:{filename:"grass_water_BL.png",width:1,animations:{}},grass_water_TBL:{filename:"grass_water_TBL.png",width:1,animations:{}},grass_water_TRL:{filename:"grass_water_TRL.png",width:1,animations:{}},grass_water_RBL:{filename:"grass_water_RBL.png",width:1,animations:{}},grass_water_TRB:{filename:"grass_water_TRB.png",width:1,animations:{}},grass_water_TRBL:{filename:"grass_water_TRBL.png",width:1,animations:{}},grass_water_corner_BL:{filename:"grass_water_corner_BL.png",width:1,animations:{}},grass_water_corner_BR:{filename:"grass_water_corner_BR.png",width:1,animations:{}},grass_water_corner_TL:{filename:"grass_water_corner_TL.png",width:1,animations:{}},grass_water_corner_TR:{filename:"grass_water_corner_TR.png",width:1,animations:{}}},E=function(){function e(t,i){if(Object(c.a)(this,e),this.scene=i,this.texture=void 0,!R[t])throw new Error("Texture atlas '"+t+"' is not defined");var n=new b.Texture(D+R[t].filename,i,!1,!0,b.Texture.NEAREST_NEAREST);n.hasAlpha=!0,this.texture=n}return Object(h.a)(e,[{key:"getTexture",value:function(){return this.texture}},{key:"detach",value:function(){this.scene.removeTexture(this.texture)}}]),e}(),z=Object.values(R).map((function(e){return e.filename}));z=z.filter((function(e,t){return z.indexOf(e)===t}));var C={},B={},L=0,D="/randomgame/resources/textures/";function I(e,t){if(B[e])return B[e];var i=P(new E(e,t).getTexture(),t);return B[e]=i,i}function P(e,t,i){var n=new b.StandardMaterial("mat",t);return n.diffuseTexture=e,i||(n.opacityTexture=e),n.specularColor=new BABYLON.Color3(0,0,0),n}function A(e){return R[e]?C[R[e].filename]:(console.warn("Image "+e+" not found!"),null)}var V=function(){function e(t,i){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";Object(c.a)(this,e),this.scene=i,this.textureAtlas=void 0,this.texture=void 0,this.animationQueue=[],this.frame=0,this.direction=1,this.interval=void 0,this.textureScale=1,this.textureAtlas=t,this.textureScale=1/R[t].width;var s=new b.Texture(D+R[t].filename,i,!1,!0,b.Texture.NEAREST_NEAREST);s.uOffset=this.textureScale*R[t].animations[a].start,s.vOffset=0,s.uScale=this.textureScale,s.vScale=1,s.hasAlpha=!0,this.texture=s,this.queue(a),this.interval=setInterval((function(){return n.tick()}),80)}return Object(h.a)(e,[{key:"getTexture",value:function(){return this.texture}},{key:"isLast",value:function(e){return this.animationQueue[this.animationQueue.length-1].texture===e}},{key:"queueOnce",value:function(e,t){this.isLast(e)||this.queue(e,t)}},{key:"queue",value:function(e,t){if(!Object.keys(R[this.textureAtlas].animations).includes(e))return console.warn("Animation does not exist"),void this.animationQueue.push({texture:"default",skippable:!0});this.animationQueue.length>1&&this.animationQueue[this.animationQueue.length-1].skippable?this.animationQueue[this.animationQueue.length-1]={texture:e,skippable:!t}:this.animationQueue.push({texture:e,skippable:!t})}},{key:"tick",value:function(){if(this.texture){this.frame+=this.direction;var e=R[this.textureAtlas].animations[this.animationQueue[0].texture],t=Math.abs(e.start-e.end),i=this.animationQueue.length>1;if(this.frame>t)switch(e.type){case"loop":this.direction=1,this.frame=0,i&&this.animationQueue.shift();break;case"once":this.direction=1,i?(this.frame=0,this.animationQueue.shift()):this.frame=t;break;case"boomerang":this.direction=-1,this.frame-=2;break;case"frame":this.direction=1,this.frame=0,i&&this.animationQueue.shift()}this.frame<0&&(this.direction=1,i?(this.frame=0,this.animationQueue.shift()):this.frame=0);var n=R[this.textureAtlas].animations[this.animationQueue[0].texture],a=n.start>n.end?-1:1;this.texture.uOffset=(this.frame*a+n.start)*this.textureScale}else console.error("Texture is null")}},{key:"detach",value:function(){this.scene.removeTexture(this.texture)}}]),e}(),F=Math.PI/4,N=function(){function e(t,i){Object(c.a)(this,e),this.object=t,this.babylonScene=i,this.attached=!0,this.mesh=void 0}return Object(h.a)(e,[{key:"detach",value:function(){this.attached&&(this.babylonScene.removeMesh(this.mesh,!0),this.attached=!1)}}]),e}(),U=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n){var a;return Object(c.a)(this,i),(a=t.call(this,e,n)).object=e,a.babylonScene=n,a}return Object(h.a)(i,[{key:"update",value:function(){var e=Object(y.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.mesh&&(this.mesh.position.z=-this.object.getSize().y*Math.cos(F)/2,this.mesh.rotation.x=-F,this.mesh.position.x=100*this.object.position.x,this.mesh.position.y=100*-this.object.position.y+this.object.getSize().y*Math.sin(F)/2,this.mesh.isPickable=!0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),i}(N),Q=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n){var a;if(Object(c.a)(this,i),(a=t.call(this,e,n)).object=e,a.babylonScene=n,a.texture=void 0,a.titleTexture=void 0,!a.babylonScene)return Object(_.a)(a);var s=e.getSize();a.mesh=b.MeshBuilder.CreatePlane(e.id,{width:s.x,height:s.y,sideOrientation:b.Mesh.FRONTSIDE},a.babylonScene),a.texture=new V("player",a.babylonScene,"default"),a.mesh.material=P(a.texture.getTexture(),a.babylonScene);var r=b.MeshBuilder.CreatePlane("title "+e.id,{width:200,height:40,sideOrientation:b.Mesh.FRONTSIDE},a.babylonScene);r.position=new b.Vector3(0,110,-3);var o=new b.DynamicTexture("titleTexture "+e.id,{width:200,height:40},a.babylonScene,!0,b.Texture.LINEAR_LINEAR);return a.titleTexture=o,r.parent=a.mesh,r.material=P(o,a.babylonScene),a.update(),a}return Object(h.a)(i,[{key:"update",value:function(){var e=Object(y.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.a)(Object(m.a)(i.prototype),"update",this).call(this),(t=this.titleTexture.getContext()).clearRect(0,0,this.titleTexture.getSize().width,this.titleTexture.getSize().height),t.fillStyle="#343434AA",t.fillRect(0,0,this.titleTexture.getSize().width,this.titleTexture.getSize().height),t.font="32px pixel",t.textBaseline="middle",t.textAlign="center",t.fillStyle="#FFFFFF",t.fillText(this.object.name,this.titleTexture.getSize().width/2,this.titleTexture.getSize().height/2),this.titleTexture.update(),.01,Math.abs(this.object.velocity.x)>.01||Math.abs(this.object.velocity.x)>.01?this.texture.queueOnce("walking"):this.texture.queueOnce("default");case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"detach",value:function(){if(this.babylonScene&&this.mesh){var e=this.mesh.getChildMeshes()[0];this.titleTexture&&e&&e.material&&(this.babylonScene.removeTexture(this.titleTexture),this.babylonScene.removeMaterial(e.material))}Object(g.a)(Object(m.a)(i.prototype),"detach",this).call(this)}}]),i}(U),Y=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n){var a;return Object(c.a)(this,i),(a=t.call(this,e,n)).id=n,a.hitbox={width:.5,height:.2},a.name="",a.controllerManager=new w,a}return Object(h.a)(i,[{key:"serialize",value:function(){var e=Object(g.a)(Object(m.a)(i.prototype),"serialize",this).call(this);return e.type=i.type,e.data={name:this.name},e}},{key:"deserialize",value:function(e){e.type===i.type&&(this.name=e.data.name,Object(g.a)(Object(m.a)(i.prototype),"deserialize",this).call(this,e))}},{key:"tick",value:function(e){Object(g.a)(Object(m.a)(i.prototype),"tick",this).call(this,e),this.update()}},{key:"attachRenderer",value:function(){var e=Object(y.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.a)(Object(m.a)(i.prototype),"attachRenderer",this).call(this,t),this.renderer=new Q(this,t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"attachControllers",value:function(e,t){e===n.Server&&this.controllerManager.attach(new O(this)),e===n.Client&&(t?this.controllerManager.attach(new M(this)):this.controllerManager.attach(new S(this)))}},{key:"getSize",value:function(){return new b.Vector2(100,200)}}],[{key:"type",get:function(){return"player"}}]),i}(x);function q(e){switch(e){case 1:return"#67943F";case 2:return"#2EB0E5";case 4:return"#FDDC86"}return"#DDDDDD"}var X=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n){var a;Object(c.a)(this,i),(a=t.call(this,e,n)).object=e,a.babylonScene=n,a.texture=void 0,a.mesh=b.MeshBuilder.CreatePlane("chunk "+e.id,{width:1600,height:1600,sideOrientation:b.Mesh.FRONTSIDE},a.babylonScene);var s=new b.DynamicTexture("chunkTexture "+e.id,{width:256,height:256},a.babylonScene,!0,b.Texture.NEAREST_NEAREST);a.texture=s;var r=P(s,a.babylonScene,!0);return a.mesh.material=r,a.update(),a}return Object(h.a)(i,[{key:"update",value:function(){var e=Object(y.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.mesh.position.x=16*this.object.position.x*100,this.mesh.position.y=16*-this.object.position.y*100,t=this.texture.getContext(),this.drawTexture(t),this.texture.update();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"detach",value:function(){this.babylonScene&&this.mesh&&this.texture&&(this.babylonScene.removeTexture(this.texture),this.mesh.material&&this.babylonScene.removeMaterial(this.mesh.material)),Object(g.a)(Object(m.a)(i.prototype),"detach",this).call(this)}},{key:"drawTexture",value:function(e){i.drawBasicTiling(this.object,e,0,0,16);for(var t=0;t<16;t++)for(var n=0;n<16;n++)this.object.ground[t]&&this.object.ground[t][n]&&2===this.object.ground[t][n]&&this.drawTransition(e,t,n,[1,3],"grass_water")}},{key:"drawTransition",value:function(e,t,i,n,a){var s=this,r=16*this.object.position.x+t-8,o=16*this.object.position.y+i-8,c="";if(n.includes(this.object.gameScene.getTile(r,o-1))&&(c+="T"),n.includes(this.object.gameScene.getTile(r+1,o))&&(c+="R"),n.includes(this.object.gameScene.getTile(r,o+1))&&(c+="B"),n.includes(this.object.gameScene.getTile(r-1,o))&&(c+="L"),"TB"===c){var h=A(a+"_T");h&&e.drawImage(h,16*t,16*i);var u=A(a+"_B");u&&e.drawImage(u,16*t,16*i)}else if("RL"===c){var l=A(a+"_R");l&&e.drawImage(l,16*t,16*i);var d=A(a+"_L");d&&e.drawImage(d,16*t,16*i)}else if(c.length>0){var f=A(a+"_"+c);f&&e.drawImage(f,16*t,16*i)}var y=function(h,u,l,d){if(n.includes(s.object.gameScene.getTile(r+h,o+u))&&!l.reduce((function(e,t){return e||c.includes(t)}),!1)){var f=A(a+"_corner_"+d);f&&e.drawImage(f,16*t,16*i)}};y(-1,-1,["L","T"],"BR"),y(1,-1,["R","T"],"BL"),y(-1,1,["L","B"],"TR"),y(1,1,["R","B"],"TL")}}],[{key:"drawBasicTiling",value:function(e,t,i,n,a){for(var s=0;s<16;s++)for(var r=0;r<16;r++)e.ground[s]&&e.ground[s][r]&&(t.fillStyle=q(e.ground[s][r]),t.fillRect(i+s*a,n+r*a,a,a))}}]),i}(N),W=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n,a){var s;return Object(c.a)(this,i),(s=t.call(this,e)).gameScene=e,s.ground=[[]],s.position=new b.Vector2(n,a),s}return Object(h.a)(i,[{key:"serialize",value:function(){return{x:this.position.x,y:this.position.y,ground:this.ground}}},{key:"deserialize",value:function(e){this.position.x=e.x,this.position.y=e.y,this.ground=e.ground,this.update()}},{key:"hasEntity",value:function(e){return e.position.x>16*this.position.x-8&&e.position.x<16*this.position.x+8&&e.position.y>16*this.position.y-8&&e.position.y<16*this.position.y+8}},{key:"attachRenderer",value:function(){var e=Object(y.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.a)(Object(m.a)(i.prototype),"attachRenderer",this).call(this,t),this.renderer=new X(this,t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"id",get:function(){return i.getId(this.position.x,this.position.y)}}],[{key:"getId",value:function(e,t){return e.toString()+"x"+t.toString()}}]),i}(k),J=function(){function e(){Object(c.a)(this,e),this.values={}}return Object(h.a)(e,[{key:"addMore",value:function(e){this.values=Object(T.a)(Object(T.a)({},this.values),e)}},{key:"add",value:function(e,t){this.values[e]=t}},{key:"remove",value:function(e){this.values[e]&&(this.values[e].detachRenderer(),delete this.values[e])}},{key:"update",value:function(e,t,i){this.values[e]&&this.values[e].deserialize(t,i)}},{key:"updateOrCreate",value:function(e,t,i,n){this.values[e]||(this.values[e]=i()),this.values[e].deserialize(t,n)}},{key:"get",value:function(e){return this.values[e]?this.values[e]:null}},{key:"includes",value:function(e){return!!this.values[e]}},{key:"forEach",value:function(e){var t=this;Object.keys(this.values).forEach((function(i,n){e(t.values[i],i,n)}))}},{key:"filter",value:function(t){var i=this,n=Object.keys(this.values),a=new e;return n.forEach((function(e,n){t(i.values[e],e,n)&&a.add(e,i.values[e])})),a}},{key:"map",value:function(e){var t=this;return Object.keys(this.values).map((function(i,n){return e(t.values[i],i,n)}))}},{key:"getValues",value:function(){return Object.values(this.values)}},{key:"getKeys",value:function(){return Object.keys(this.values)}},{key:"length",value:function(){return this.getKeys().length}}]),e}(),K=function(){function e(){Object(c.a)(this,e),this.entities=new J,this.chunks=new J,this.timeStart=(new Date).getTime()}return Object(h.a)(e,[{key:"tickAll",value:function(e){this.entities.forEach((function(t){return t.tick(e)})),this.chunks.forEach((function(t){return t.tick(e)}))}},{key:"getTile",value:function(e,t){var i=Math.floor(e)+8,n=Math.floor(t)+8,a=Math.floor(i/16),s=Math.floor(n/16),r=this.chunks.get(W.getId(a,s));return r&&r.ground[i-16*a]&&r.ground[i-16*a][n-16*s]?r.ground[i-16*a][n-16*s]:-1}},{key:"getColisions",value:function(e){return this.entities.filter((function(t){return e!==t&&t.colidesWith(e)}))}},{key:"getClosestEntityOfType",value:function(e,t){var i=this,n=this.entities.filter((function(e){return e instanceof t})).getValues().sort((function(t,n){return i.distance(e,t)-i.distance(e,n)}));return n[0]?{entity:n[0],distance:this.distance(e,n[0])}:null}},{key:"distance",value:function(e,t){return Math.sqrt(Math.pow(e.position.x-t.position.x,2)+Math.pow(e.position.y-t.position.y,2))}},{key:"getTime",value:function(){var e=Math.abs((new Date).getTime()-this.timeStart)/1e3*600+43200;return{day:e/86400,hour:e/3600%24,min:e/60%60,sec:e%60}}}]),e}(),G={left:65,right:68,up:87,down:83},H=i(181),Z=i.n(H),$=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n,a){var s;Object(c.a)(this,i),(s=t.call(this,e,n)).object=e,s.babylonScene=n,s.getMaterial=a;var r=e.getSize();return s.mesh=b.MeshBuilder.CreatePlane(e.id,{width:r.x,height:r.y,sideOrientation:b.Mesh.FRONTSIDE},s.babylonScene),s.update(),s}return Object(h.a)(i,[{key:"update",value:function(){var e=Object(y.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.a)(Object(m.a)(i.prototype),"update",this).call(this),this.mesh.material=I(this.getMaterial(),this.babylonScene);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),i}(U),ee=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n){var a;return Object(c.a)(this,i),(a=t.call(this,e,n)).id=n,a.hitbox={width:.2,height:.2},a.size=void 0,a.controllerManager=new w,a}return Object(h.a)(i,[{key:"serialize",value:function(){var e=Object(g.a)(Object(m.a)(i.prototype),"serialize",this).call(this);return e.type=i.type,e.data={size:this.size},e}},{key:"deserialize",value:function(e){e.type===i.type&&(this.size=e.data.size,Object(g.a)(Object(m.a)(i.prototype),"deserialize",this).call(this,e))}},{key:"attachRenderer",value:function(){var e=Object(y.a)(f.a.mark((function e(t){var n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.a)(Object(m.a)(i.prototype),"attachRenderer",this).call(this,t),this.renderer=new $(this,t,(function(){return n.getMaterial()}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"attachControllers",value:function(e){e===n.Server&&this.controllerManager.attach(new O(this)),e===n.Client&&this.controllerManager.attach(new O(this))}},{key:"getMaterial",value:function(){switch(this.size){case 1:return"tree_small";case 2:return"tree_big";case 3:return"tree_short";case 4:return"tree_tall"}}},{key:"getSize",value:function(){return new b.Vector2(200,400)}}],[{key:"type",get:function(){return"tree"}}]),i}(x),te=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n){var a;return Object(c.a)(this,i),(a=t.call(this,e,n)).id=n,a.hitbox={width:.2,height:.2},a.size=void 0,a.controllerManager=new w,a}return Object(h.a)(i,[{key:"serialize",value:function(){var e=Object(g.a)(Object(m.a)(i.prototype),"serialize",this).call(this);return e.type=i.type,e.data={size:this.size},e}},{key:"deserialize",value:function(e){e.type===i.type&&(this.size=e.data.size,Object(g.a)(Object(m.a)(i.prototype),"deserialize",this).call(this,e))}},{key:"attachRenderer",value:function(){var e=Object(y.a)(f.a.mark((function e(t){var n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.a)(Object(m.a)(i.prototype),"attachRenderer",this).call(this,t),this.renderer=new $(this,t,(function(){return 1===n.size?"rock_small":"rock_big"}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"attachControllers",value:function(e){e===n.Server&&this.controllerManager.attach(new O(this)),e===n.Client&&this.controllerManager.attach(new O(this))}},{key:"getSize",value:function(){return new b.Vector2(100,100)}}],[{key:"type",get:function(){return"stone"}}]),i}(x),ie=i(182),ne=i.n(ie),ae=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,e)).object=e,n.angle=0,n}return Object(h.a)(i,[{key:"tick",value:function(e){var t=this,i=this.object.gameScene.getClosestEntityOfType(this.object,Y);if(i&&i.distance<2&&(this.object.inLove=i.entity.id),i&&i.distance<10){var n=0;this.object.inLove!==i.entity.id&&(n=Math.PI),this.angle=Math.atan2(i.entity.position.y-this.object.position.y,i.entity.position.x-this.object.position.x)+n,this.object.velocity.x=.04*Math.cos(this.angle),this.object.velocity.y=.04*Math.sin(this.angle)}else this.angle+=2*(Math.random()-.5)*.03*e,this.object.velocity.x=.01*Math.cos(this.angle),this.object.velocity.y=.01*Math.sin(this.angle);var a=this.object.position.x,s=this.object.position.y;this.object.position.x+=this.object.velocity.x,this.object.position.y+=this.object.velocity.y,Math.abs(this.object.velocity.x)<.001&&(this.object.velocity.x=0),Math.abs(this.object.velocity.y)<.001&&(this.object.velocity.y=0);var r=this.object.gameScene.getColisions(this.object);if(r.length()>0){var o=!1,c=!1;r.forEach((function(e){var i=!(s-t.object.hitbox.height<e.position.y+e.hitbox.height)&&t.object.position.y-t.object.hitbox.height<e.position.y+e.hitbox.height,n=!(a+t.object.hitbox.width>e.position.x-e.hitbox.width)&&t.object.position.x+t.object.hitbox.width>e.position.x-e.hitbox.width,r=!(s+t.object.hitbox.height>e.position.y-e.hitbox.height)&&t.object.position.y+t.object.hitbox.height>e.position.y-e.hitbox.height,h=!(a-t.object.hitbox.width<e.position.x+e.hitbox.width)&&t.object.position.x-t.object.hitbox.width<e.position.x+e.hitbox.width;o=o||n||h,c=c||i||r})),o&&(this.object.position.x=a,this.object.velocity.x=0),c&&(this.object.position.y=s,this.object.velocity.y=0)}this.object.setDirty()}}]),i}(j),se=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n,a){var s;Object(c.a)(this,i),(s=t.call(this,e,n)).object=e,s.babylonScene=n,s.material=a;var r=e.getSize();return s.mesh=b.MeshBuilder.CreatePlane(e.id,{width:r.x,height:r.y,sideOrientation:b.Mesh.FRONTSIDE},s.babylonScene),s.mesh.material=I(a,s.babylonScene),s.update(),s}return i}(U),re=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e,n){var a;return Object(c.a)(this,i),(a=t.call(this,e,n)).id=n,a.hitbox={width:.2,height:.2},a.inLove="",a.controllerManager=new w,a}return Object(h.a)(i,[{key:"serialize",value:function(){var e=Object(g.a)(Object(m.a)(i.prototype),"serialize",this).call(this);return e.type=i.type,e.data={inLove:this.inLove},e}},{key:"deserialize",value:function(e){e.type===i.type&&Object(g.a)(Object(m.a)(i.prototype),"deserialize",this).call(this,e)}},{key:"attachRenderer",value:function(){var e=Object(y.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.a)(Object(m.a)(i.prototype),"attachRenderer",this).call(this,t),this.renderer=new se(this,t,"chicken");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"attachControllers",value:function(e){e===n.Server&&this.controllerManager.attach(new ae(this)),e===n.Client&&(this.controllerManager.attach(new S(this)),this.controllerManager.invoke("setSmoothTime",200))}},{key:"getSize",value:function(){return new b.Vector2(100,100)}}],[{key:"type",get:function(){return"chicken"}}]),i}(x),oe=function(){function e(t,i,n){Object(c.a)(this,e),this.apiUrl=t,this.scene=i,this.getBabylonScene=n,this.socket=void 0,this.userId=void 0,this.opened=void 0,this.callbacks={authenticated:function(){},updated:function(){},invalidPassword:function(){},disconnect:function(){}}}return Object(h.a)(e,[{key:"on",value:function(e,t){this.callbacks[e]=t}},{key:"close",value:function(){this.socket.disconnect()}},{key:"open",value:function(){var e=this;this.opened=!0,this.socket=Z()(this.apiUrl),this.setListeners(),this.socket.on("auth",(function(t){e.userId=t.id,e.callbacks.authenticated(t),console.log("Joined game with player ",t.data.name," ("+t.id+")")}))}},{key:"sendPlayerUpdate",value:function(e){var t=e.serialize();this.socket.emit("update",t)}},{key:"requestChunk",value:function(e,t){this.socket.emit("mapRequest",{x:e,y:t})}},{key:"auth",value:function(e,t){var i={name:e,passwordHash:ne()(t)};this.socket.emit("login",i)}},{key:"setListeners",value:function(){var e=this;this.socket.on("entities",function(){var t=Object(y.a)(f.a.mark((function t(i){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.removed.forEach((function(t){return t.id!==e.userId&&e.scene.entities.remove(t.id)})),i.updated.forEach((function(t){return t.id!==e.userId&&e.scene.entities.updateOrCreate(t.id,t,(function(){return e.createEntity(t)}))})),e.scene.timeStart=i.time,e.callbacks.updated({});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.socket.on("mapChunk",function(){var t=Object(y.a)(f.a.mark((function t(i){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=W.getId(i.x,i.y),e.scene.chunks.updateOrCreate(n,i,(function(){var t=new W(e.scene,i.x,i.y);return t.attachRenderer(e.getBabylonScene()),t}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.socket.on("err",function(){var t=Object(y.a)(f.a.mark((function t(i){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:switch(i.error){case"credentials":e.callbacks.invalidPassword(i)}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"createEntity",value:function(e){var t=null;switch(e.type){case"player":t=new Y(this.scene,e.id);break;case"tree":t=new ee(this.scene,e.id);break;case"stone":t=new te(this.scene,e.id);break;case"chicken":t=new re(this.scene,e.id)}if(t)return t.deserializeImmediatelly(e),t.attachControllers(n.Client),t;console.error('Entity "'+e.type+" does not exist!")}}]),e}();function ce(e,t,i,n){e.strokeStyle="#000000",e.fillStyle="#FFFFFF",e.lineWidth=2,e.strokeText(t,i,n),e.strokeText(t,i+1,n+1),e.fillText(t,i,n)}var he=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,e)).gameScene=void 0,n.me=null,n.babylonScene=void 0,n.guiTexture=void 0,n.networkClient=void 0,n.state={loggedIn:!1},n.timer=void 0,n.zoom=1,n.renderDistance=3,n.debug=!1,n.loginRef=Object(a.createRef)(),n.passwordRef=Object(a.createRef)(),n.mouseEntity=void 0,n.gameScene=new K,n.networkClient=new oe(n.props.apiUrl,n.gameScene,(function(){return n.babylonScene})),n.networkClient.on("authenticated",(function(e){return n.initGame(e)})),n.networkClient.on("invalidPassword",(function(){n.loginRef.current&&n.passwordRef.current&&(n.loginRef.current.classList.add("shake"),n.passwordRef.current.classList.add("shake"),setTimeout((function(){n.loginRef.current&&n.passwordRef.current&&(n.loginRef.current.classList.remove("shake"),n.passwordRef.current.classList.remove("shake"))}),600))})),document.addEventListener("keydown",(function(e){n.gameScene.entities.forEach((function(t){return t.controllerManager.invoke("keyDown",e.keyCode)}))})),document.addEventListener("keyup",(function(e){n.gameScene.entities.forEach((function(t){return t.controllerManager.invoke("keyUp",e.keyCode)}))})),document.addEventListener("wheel",(function(e){n.zoom+=e.deltaY/Math.abs(e.deltaY)*.12,n.zoom<.5&&(n.zoom=.5),n.zoom>3&&(n.zoom=3)})),window.addEventListener("resize",(function(e){n.resize()})),n}return Object(h.a)(i,[{key:"componentDidMount",value:function(){this.resize(),this.networkClient.open()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),this.networkClient.close()}},{key:"initGame",value:function(e){var t=this;this.setState({loggedIn:!0}),this.me=new Y(this.gameScene,e.id),this.me.attachRenderer(this.babylonScene),this.me.attachControllers(n.Client,!0),this.me.controllerManager.invoke("bindKeys",G),this.me.deserializeImmediatelly(e),this.gameScene.entities.add(e.id,this.me),window.player=this.me,window.scene=this.gameScene,window.enableDebug=function(){t.babylonScene&&t.babylonScene.debugLayer.show(),t.debug=!0},this.timer=setInterval(Object(y.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.me&&t.networkClient.sendPlayerUpdate(t.me);case 1:case"end":return e.stop()}}),e)}))),100)}},{key:"tick",value:function(e){if(this.gameScene.entities.forEach((function(t){return t.tick(e)})),this.unloadUnusedComponents(),this.requestChunks(),this.guiTexture)if(this.me){var t=this.guiTexture.getContext(),i=this.guiTexture.getSize().width,n=this.guiTexture.getSize().height;t.clearRect(0,0,i,n),function(e,t,i){var n=e.getContext(),a=e.getSize().width-30-64,s=Math.floor(2*(Math.floor(i.position.x)-i.position.x)),r=Math.floor(2*(Math.floor(i.position.y)-i.position.y));n.fillStyle="#000000",n.fillRect(a-64-3,17,136,136);for(var o=-32;o<=33;o++)for(var c=-32;c<=33;c++)n.fillStyle=q(t.getTile(i.position.x+o,i.position.y+c)),n.fillRect(a+2*o+s,84+2*c+r,2,2);t.entities.filter((function(e){return Math.abs(e.position.x-i.position.x)<=33.5&&Math.abs(e.position.y-i.position.y)<=33.5})).forEach((function(e){n.fillStyle=function(e){switch(e){case"tree":return"#2A4323aa";case"player":return"#000dff";case"stone":return"#ddddddaa";case"chicken":return"#ffffff"}return"#DDDDDD"}(e.serialize().type),n.fillRect(Math.floor(a+2*(e.position.x-i.position.x)),Math.floor(84+2*(e.position.y-i.position.y)),2,2)})),n.lineWidth=3,n.strokeStyle="#000000",n.strokeRect(a-64-3+2,19,132,132),n.font="16px pixel",n.textBaseline="top",n.textAlign="center",ce(n,"x",a,161),n.textAlign="right",ce(n,Math.round(i.position.x).toString(),a-10,161),n.textAlign="left",ce(n,Math.round(i.position.y).toString(),a+10,161);var h=t.getTime();n.textAlign="center",ce(n,":",a,181),n.textAlign="right",ce(n,Math.floor(h.hour).toString(),a-5,181),n.textAlign="left",ce(n,Math.floor(h.min).toString().padStart(2,"0"),a+5,181),n.textAlign="center",ce(n,"(den "+Math.floor(h.day).toString()+".)",a,201),e.update()}(this.guiTexture,this.gameScene,this.me),this.debug&&function(e,t,i){var n=e.getContext(),a=20,s={FPS:(1e3/i).toFixed(2),"Enabled entities":t.entities.filter((function(e){return e.getVisibility()})).length()+" (of "+t.entities.length()+" loaded)","Enabled chunks":t.chunks.filter((function(e){return e.getVisibility()})).length()+" (of "+t.chunks.length()+" loaded)"};n.font="16px pixel",n.textBaseline="top",n.textAlign="left",Object.keys(s).forEach((function(e){ce(n,e+": "+s[e],30,a),a+=20})),e.update()}(this.guiTexture,this.gameScene,e),this.guiTexture.update()}else{var a=this.guiTexture.getContext(),s=this.guiTexture.getSize().width,r=this.guiTexture.getSize().height;a.fillStyle="#33334C",a.fillRect(0,0,s,r),a.fillStyle="#FFFFFF",a.font="20px pixel",a.textBaseline="middle",a.textAlign="center",ce(a,"P\u0159ipojov\xe1n\xed k serveru...",s/2,r/2),this.guiTexture.update()}}},{key:"resize",value:function(){var e=document.getElementById("game");e&&(e.width=window.innerWidth,e.height=window.innerHeight)}},{key:"onSceneMount",value:function(e){var t=this,i=e.scene;this.babylonScene=i;var n=new b.UniversalCamera("Camera",new b.Vector3(0,0,1500),this.babylonScene);n.rotation=new b.Vector3(-F,0,0);var a=b.MeshBuilder.CreateCylinder("skyBox",{height:15e4,diameterTop:14400,diameterBottom:4800,tessellation:24},this.babylonScene),s=new b.DirectionalLight("nightLight",new b.Vector3(0,1,2),this.babylonScene);s.diffuse=new BABYLON.Color3(.5,.5,1);var r=new b.DirectionalLight("dayLight",new b.Vector3(0,1,2),this.babylonScene);r.diffuse=new BABYLON.Color3(1,1,.8);var o=new b.StandardMaterial("skyBox",this.babylonScene);o.backFaceCulling=!1,o.diffuseColor=new BABYLON.Color3(0,0,0),o.specularColor=new BABYLON.Color3(0,0,0),o.disableLighting=!0,a.material=o,a.rotation=new b.Vector3(Math.PI/2,0,0),this.guiTexture=v.a.CreateFullscreenUI("GUI",!0,i),i.onPointerDown=function(e,i){i.hit&&i.pickedMesh&&!i.pickedMesh.name.startsWith("chunk")?(t.mouseEntity=t.gameScene.entities.get(i.pickedMesh.name.split(" ")[1]),t.mouseEntity&&t.mouseEntity.controllerManager.invoke("mouseDown",e.button)):t.mouseEntity=null},i.onPointerUp=function(e){t.mouseEntity&&t.mouseEntity.controllerManager.invoke("mouseUp",e.button)},i.getEngine().runRenderLoop((function(){t.tick(i.getEngine().getDeltaTime()),Object(y.a)(f.a.mark((function e(){var i,o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.me&&(n.position=new b.Vector3(100*t.me.position.x,100*-t.me.position.y-1500*t.zoom*Math.tan(F),-1500*t.zoom),(i=t.gameScene.getTime()).hour>9&&i.hour<18&&(r.intensity=1.5,s.intensity=0),(i.hour>21||i.hour<6)&&(r.intensity=0,s.intensity=.5),i.hour>6&&i.hour<9&&(o=(i.hour-6)/3,r.intensity=1.5*o,s.intensity=.5*(1-o)),i.hour>18&&i.hour<21&&(c=(i.hour-18)/3,r.intensity=1.5*(1-c),s.intensity=.5*c),console.log(r.intensity,s.intensity),a.position.x=100*t.me.position.x,a.position.y=100*-t.me.position.y),t.renderDistance=Math.min(Math.ceil(2*t.zoom),3);case 2:case"end":return e.stop()}}),e)})))(),i&&i.render()}))}},{key:"unloadUnusedComponents",value:function(){var e=this;this.me&&(this.gameScene.chunks.forEach((function(t){var i=Math.abs(Math.round(e.me.position.x/16)-t.position.x),n=Math.abs(Math.round(e.me.position.y/16)-t.position.y);i>e.renderDistance||n>e.renderDistance?(t.setVisibility(!1),(i>5||n>5)&&e.gameScene.chunks.remove(t.id)):t.setVisibility(!0)})),this.gameScene.entities.forEach((function(t){var i=Math.abs(Math.round(e.me.position.x)-t.position.x)/16,n=Math.abs(Math.round(e.me.position.y)-t.position.y)/16;i>e.renderDistance||n>e.renderDistance?(t.setVisibility(!1),(i>5||n>5)&&e.gameScene.entities.remove(t.id)):t.setVisibilityAttachRenderer(!0,e.babylonScene)})))}},{key:"requestChunks",value:function(){if(this.me)for(var e=-3;e<=3;e++)for(var t=-3;t<=3;t++){var i=Math.round(this.me.position.x/16)+e,n=Math.round(this.me.position.y/16)+t,a=W.getId(i,n);if(!this.gameScene.chunks.includes(a)){this.networkClient.requestChunk(i,n);var s=new W(this.gameScene,i,n);s.attachRenderer(this.babylonScene),this.gameScene.chunks.add(a,s)}}}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,!this.state.loggedIn&&s.a.createElement("div",{className:"center"},s.a.createElement("p",null,"P\u0159ihlaste se, nebo si vytvo\u0159te \xfa\u010det:"),s.a.createElement("p",null,s.a.createElement("input",{type:"text",placeholder:"Jm\xe9no",ref:this.loginRef})),s.a.createElement("p",null,s.a.createElement("input",{type:"password",placeholder:"Heslo",ref:this.passwordRef})),s.a.createElement("p",null,s.a.createElement("button",{onClick:function(){return e.networkClient.auth(e.loginRef.current.value,e.passwordRef.current.value)}},"P\u0159ihl\xe1sit se!"))),s.a.createElement(p.a,{antialias:!0,canvasId:"game"},s.a.createElement(p.b,{onSceneMount:function(t){return e.onSceneMount(t)}},s.a.createElement(s.a.Fragment,null))))}}]),i}(s.a.Component),ue=function(e){Object(u.a)(i,e);var t=Object(l.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,e)).apiUrl="https://randombot-server.herokuapp.com/",n.state={status:"loading",textures:{loaded:0,of:0}},window.location.host.includes("localhost")&&(n.apiUrl="http://localhost:80/"),n}return Object(h.a)(i,[{key:"componentDidMount",value:function(){var e,t,i=this;this.setState({textures:{loaded:0,of:(e=function(){i.setState({status:"ingame"})},t=function(e,t){i.setState({textures:{loaded:e,of:t}})},0===z.length&&(t&&t(0,z.length),e()),z.forEach((function(i){C[i]=new Image,C[i].onload=function(){L++,t&&t(L,z.length),L===z.length&&e()},C[i].onerror=function(){console.error("Error loading resource file: ",i)},C[i].src=D+i})),z.length)}})}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,"loading"===this.state.status&&s.a.createElement("div",{className:"center"},"Na\u010d\xedt\xe1n\xed textur... (",this.state.textures.loaded,"/",this.state.textures.of,")"),"ingame"===this.state.status&&s.a.createElement(he,{apiUrl:this.apiUrl}))}}]),i}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[183,1,2]]]);
//# sourceMappingURL=main.cd1155a6.chunk.js.map